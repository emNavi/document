import{_ as e,c as l,a as s,d as n,b as t,e as p,o as d,r}from"./app-2tArAyrn.js";const h={},c={class:"vp-steps"},o={class:"hint-container details"},m={class:"hint-container details"};function k(v,i){const a=r("LinkCard");return d(),l("div",null,[i[5]||(i[5]=s("h2",{id:"算法使用",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#算法使用"},[s("span",null,"算法使用")])],-1)),s("div",c,[s("ul",null,[i[4]||(i[4]=n(`<li><h3 id="选择合适的场景" tabindex="-1"><a class="header-anchor" href="#选择合适的场景"><span>选择合适的场景</span></a></h3><p>由于相机前置安装，因此无人机不能检测到机尾方向的障碍物。因此避免设置让无人机大转向后立即避障的场景。 建议在空中悬停时再运行，因为位于地面的无人机会认为自身在膨胀后的障碍物内。</p></li><li><h3 id="设定航点" tabindex="-1"><a class="header-anchor" href="#设定航点"><span>设定航点</span></a></h3><p>程序将读取配置文件中设置的目标点，并依次执行抵达他们的飞行任务。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开配置文件，翻到大约第 20 行</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">src/global_interface/config/ego_plan/point_param.xml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>预设最大可执行目标点数默认为6个。这里 <code>point_num</code> 数量为实际执行的目标点个数。 比如这里 <code>point_num</code> 设置为 <code>2</code> 个 (&lt; <code>6</code>)，那就只执行前2个点，后面的目标点都不执行。</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 预设目标点数 --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint_num: 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里给出具体每个目标点的坐标：</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 目标点为相对里程计初始化点的x、y、z坐标，单位 m --&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 预设目标点，按顺序执行飞行 --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint0_x:  1.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint0_y:  0.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint0_z:  0.5</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint1_x:  2.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint1_y:  0.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint1_z:  1.0</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">......</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 建议最后一个点设置为 0 0 1 ，以方便降落 --&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="hint-container details"><summary>默认的 6个目标点不够用，想要设置更多？</summary><p>在配置文件 <code>point_param.xml</code> 的末尾继续添加：</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark has-focused-lines vp-code"><code><span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint4_x:  1.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint4_y:  0.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint4_z:  0.5</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint5_x:  2.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint5_y:  0.0</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint5_z:  1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 末尾继续添加新目标点（需包含XYZ三个值，并且需要注意命名） --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint6_x:  0.0 </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 新增加点的 X 值 --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint6_y:  0.0 </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 新增加点的 Y 值 --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fsm/waypoint6_z:  1.0 </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 新增加点的 Z 值 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">......</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details></li><li><h3 id="运行算法" tabindex="-1"><a class="header-anchor" href="#运行算法"><span>运行算法</span></a></h3><p>手持无人机，先启动视觉里程计，再启动 Ego-Planner，即可看到实时规划轨迹结果。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开第一个终端，初始化无人机并运行 Fast-LIO2里程计算法</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X152b</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scripts/inti_uav.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开第二个终端，启动 Vins-Fusion 视觉里程计</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X152b</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scripts/run_vinsfusion.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开第三个终端，启动 Ego-Planner 规划算法</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X152b</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> src/run_egoplanner.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,3)),s("li",null,[i[3]||(i[3]=s("h3",{id:"评估和可视化",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#评估和可视化"},[s("span",null,"评估和可视化")])],-1)),s("details",o,[i[1]||(i[1]=s("summary",null,"[可选] 使用 Foxglove 远程可视化",-1)),i[2]||(i[2]=s("p",null,[t("算法运行过程中，打开 Foxglove，可对程序运行状况进行可视化，如下图所示： "),s("img",{src:"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_and_ego_planner.png",alt:"vins_fusion_and_ego_planner.png"})],-1)),s("details",m,[i[0]||(i[0]=s("summary",null,"这里提供了布局配置文件，在Foxglove中导入该布局，实现上图",-1)),p(a,{title:"点击下载本例中的 Foxglove 布局图（需解压后导入）",href:"https://file.emnavi.tech/MEDIA_ASSETS/X152b/x152b_foxglove_layout.zip"})])])])])]),i[6]||(i[6]=n('<h2 id="常见问题" tabindex="-1"><a class="header-anchor" href="#常见问题"><span>常见问题</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Q: 无人机在穿越障碍时会撞到障碍物。</p><p>可以通过录制rosbag包离线运行算法或手持无人机到撞机点附近，复现异常场景。可能的原因包含：</p><p>1、无人机飞行太快，Ego-Planner 规划结果还未能完全得到执行或里程计延迟太高</p><p>2、在撞机点附近的深度图，导致生成的点云占据栅格地图出现非理想情况（生成错误或生成缺失）</p><p>通常的做法是先检查相机在撞机点附近的深度图可靠（没有大片空洞或者异常点云）</p><p>再考虑调整场地环境（环境灯光、障碍物摆放空间关系）、深度相机参数、点云占据栅格生成参数等来保证该处的规划可行。</p></div><div class="hint-container warning"><p class="hint-container-title">Q: 执行脚本后无法进行 ego-planner 规划，飞机保持悬停状态</p><p>若终端提示 <code>WAIT LOCAL_MAP</code>，则说明 ego-planner没有收到点云数据，需要检查 <code>local_map</code> 话题内容是否有效。 若终端提示大量爆红错误，请根据提示信息解决问题（例如规划终点位于障碍物内或不可达、 当前位于障碍物内无法出去）</p></div>',3))])}const g=e(h,[["render",k],["__file","index.html.vue"]]),A=JSON.parse('{"path":"/X152b/Ego-Planner%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95/","title":"Ego-Planner 规划算法","lang":"zh-CN","frontmatter":{"title":"Ego-Planner 规划算法","createTime":"2024/10/20 00:09:27","permalink":"/X152b/Ego-Planner规划算法/","readingTime":false,"description":"算法使用 选择合适的场景 由于相机前置安装，因此无人机不能检测到机尾方向的障碍物。因此避免设置让无人机大转向后立即避障的场景。 建议在空中悬停时再运行，因为位于地面的无人机会认为自身在膨胀后的障碍物内。 设定航点 程序将读取配置文件中设置的目标点，并依次执行抵达他们的飞行任务。 预设最大可执行目标点数默认为6个。这里 point_num 数量为实际执行...","head":[["meta",{"property":"og:url","content":"https://emnavi.tech/X152b/Ego-Planner%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95/"}],["meta",{"property":"og:site_name","content":"emNavi"}],["meta",{"property":"og:title","content":"Ego-Planner 规划算法"}],["meta",{"property":"og:description","content":"算法使用 选择合适的场景 由于相机前置安装，因此无人机不能检测到机尾方向的障碍物。因此避免设置让无人机大转向后立即避障的场景。 建议在空中悬停时再运行，因为位于地面的无人机会认为自身在膨胀后的障碍物内。 设定航点 程序将读取配置文件中设置的目标点，并依次执行抵达他们的飞行任务。 预设最大可执行目标点数默认为6个。这里 point_num 数量为实际执行..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_and_ego_planner.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-27T10:27:15.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-27T10:27:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Ego-Planner 规划算法\\",\\"image\\":[\\"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_and_ego_planner.png\\"],\\"dateModified\\":\\"2025-09-27T10:27:15.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"算法使用","slug":"算法使用","link":"#算法使用","children":[]},{"level":2,"title":"常见问题","slug":"常见问题","link":"#常见问题","children":[]}],"readingTime":{"minutes":3.35,"words":1005},"git":{"createdTime":1758613099000,"updatedTime":1758968835000,"contributors":[{"name":"Derkai","email":"2363104914@qq.com","commits":1}]},"autoDesc":true,"filePathRelative":"notes/X152b/2.算法部署/3.Ego-Planner规划算法.md"}');export{g as comp,A as data};
