import{_ as a,c as o,a as i,d as e,b as n,e as l,o as p,r}from"./app-2tArAyrn.js";const d={},c={class:"vp-steps"},h={class:"hint-container details"},m={class:"hint-container details"};function u(v,s){const t=r("LinkCard");return p(),o("div",null,[s[7]||(s[7]=i("h2",{id:"算法使用",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#算法使用"},[i("span",null,"算法使用")])],-1)),i("div",c,[i("ul",null,[s[5]||(s[5]=e(`<li><h3 id="选择合适的场景" tabindex="-1"><a class="header-anchor" href="#选择合适的场景"><span>选择合适的场景</span></a></h3><details class="hint-container details"><summary>我应当在什么场景下使用该算法 ？</summary><p>算法运行前，先将无人机放置在平稳的地方，且相机视角方向有足够静态特征的场景（不推荐在过暗、过曝、少纹理、运动物体多等地方），如下图所示：</p><p><img src="https://file.emnavi.tech/MEDIA_ASSETS/X152b/comparison_of_test_scenarios.png" alt="comparison_of_test_scenarios.png"></p></details></li><li><h3 id="运行算法" tabindex="-1"><a class="header-anchor" href="#运行算法"><span>运行算法</span></a></h3><p>当无人机放置好后，可以开始运行算法：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开第一个终端，初始化无人机</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X152b</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scripts/init_uav.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打开第二个终端，启动 Vins-Fusion 视觉里程计</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X152b</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scripts/run_vinsfusion.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><h3 id="判断是否正常初始化" tabindex="-1"><a class="header-anchor" href="#判断是否正常初始化"><span>判断是否正常初始化</span></a></h3><details class="hint-container details"><summary>如何判断算法是否正常完成初始化 ？</summary><p>当终端提示 <code>Initialization finish!</code> 时，表明 Vins-Fusion 初始化完成，如下图所示：</p><p><img src="https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_init_result.png" alt="vins_fusion_init_result.png"></p></details></li>`,3)),i("li",null,[s[3]||(s[3]=i("h3",{id:"评估和可视化",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#评估和可视化"},[i("span",null,"评估和可视化")])],-1)),s[4]||(s[4]=i("p",null,[n("初始化完成后，然后用手缓慢拿起无人机，在纹理充足的场地中慢速（ <1m/s）走一段距离,一般可以通过绕场地一圈回到出发点，观察里程计输出ROS话题 "),i("code",null,"/mavros/vision_pose/pose.pose.position"),n(" 结果值是否与初始值（"),i("code",null,"x:0 y:0 z:0"),n("）接近。如果偏差能控制在 cm 数量级，则表明 Vins-Fusion 运行良好。")],-1)),i("details",h,[s[1]||(s[1]=i("summary",null,"[可选] 使用 Foxglove 远程可视化",-1)),s[2]||(s[2]=i("p",null,[n("算法运行过程中，打开 Foxglove，可对程序运行状况进行可视化，如下图所示： "),i("img",{src:"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_demo.png",alt:"vins_fusion_demo.png"})],-1)),i("details",m,[s[0]||(s[0]=i("summary",null,"这里提供了布局配置文件，在Foxglove中导入该布局，实现上图",-1)),l(t,{title:"点击下载 Foxglove 的 Vins-Fusion布局图（需解压后导入）",href:"https://file.emnavi.tech/MEDIA_ASSETS/X152b/x152b_foxglove_layout.zip"})])])])]),s[6]||(s[6]=e('<h2 id="常见问题" tabindex="-1"><a class="header-anchor" href="#常见问题"><span>常见问题</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Q: 初始化失败，终端提示 <code>feature tracking not enough, please slowly move you device</code></p><p>初始化阶段相机视野中可用于跟踪的特征点过少，需要将无人机放置相机视角方向有足够静态特征的场景（不推荐在过暗、过曝、少纹理、运动物体多等地方）中重新运行。</p></div><div class="hint-container warning"><p class="hint-container-title">Q: 初始化无论是否完成，终端大量提示 <code>numerical unstable in preintegration</code> 或 <code>wait for imu ...</code></p><p>检查imu相关话题数据是否以正常频率更新（默认200Hz左右），或者检查标定情况，外参差异过大也会导致初始化失败。（例如正负号写反导致某个轴旋转了90度以上）</p></div><div class="hint-container warning"><p class="hint-container-title">Q: 初始化完成后，依然会出现里程计飘的问题</p><p>可以根据现象一步步排查</p><p>1、如果是初始化后，静止不动都会直接飘了，需要看是否有（动态物体、频闪的光源等）大量存在于相机视野中，这些会导致 Vins-Fusion 认为场景在运动；</p><p>2、也可能是初始化过程中，即IMU预积分阶段时，无人机处于非静止状态，放大了无人机陀螺仪噪声估计误差。</p><p>3、可能是内外参关系与实际情况相差过大。需要检查相机和飞控是否牢固，排除因为摔飞机导致结构位移。或者需要重新标定内外参信息。</p><p>4、终端大量提示 <code>img0_buff</code> ，这表明处理图像被积压，可能原因（温度过高导致CPU降频、 相机帧率、分辨率设置过高等）</p></div><div class="hint-container warning"><p class="hint-container-title">Q: 只给了一个粗糙的外参，但是开启自动优化后依然不准，或直接跑崩</p><p>可能的原因包含：</p><p>1、检查相机和IMU是否存在明显的结构松动情况</p><p>2、检查所给内外参是否明显的超过实际情况（例如相机到IMU的旋转矩阵在某个轴超过90度），需要重新联合标定相机-IMU</p><p>3、在进行标定自动优化时，注意不要用手或其他东西遮挡摄像头视野；手持绕场进行外参标定时，移动速度不易过快；确保相机画面能观察到足够稳定的场地纹理</p></div><div class="hint-container warning"><p class="hint-container-title">Q: 在室内表现还行，但是在户外场景或者大的空间就不太行。</p><p>大概率问题都是相机基线过短造成的问题，失去尺度是比较正常的。（因为无人机尺寸限制，相机基线不好做很长，而 Realsense D430 基线只有5cm左右，难以应付开阔的大户外场景。）</p></div>',6))])])}const _=a(d,[["render",u],["__file","index.html.vue"]]),f=JSON.parse('{"path":"/X152b/Vins-Fusion%E8%A7%86%E8%A7%89%E9%87%8C%E7%A8%8B%E8%AE%A1/","title":"Vins-Fusion 视觉里程计","lang":"zh-CN","frontmatter":{"title":"Vins-Fusion 视觉里程计","createTime":"2024/10/20 00:09:03","permalink":"/X152b/Vins-Fusion视觉里程计/","readingTime":false,"description":"算法使用 选择合适的场景 我应当在什么场景下使用该算法 ？ 算法运行前，先将无人机放置在平稳的地方，且相机视角方向有足够静态特征的场景（不推荐在过暗、过曝、少纹理、运动物体多等地方），如下图所示： comparison_of_test_scenarios.png 运行算法 当无人机放置好后，可以开始运行算法： 判断是否正常初始化 如何判断算法是否正常完...","head":[["meta",{"property":"og:url","content":"https://emnavi.tech/X152b/Vins-Fusion%E8%A7%86%E8%A7%89%E9%87%8C%E7%A8%8B%E8%AE%A1/"}],["meta",{"property":"og:site_name","content":"emNavi"}],["meta",{"property":"og:title","content":"Vins-Fusion 视觉里程计"}],["meta",{"property":"og:description","content":"算法使用 选择合适的场景 我应当在什么场景下使用该算法 ？ 算法运行前，先将无人机放置在平稳的地方，且相机视角方向有足够静态特征的场景（不推荐在过暗、过曝、少纹理、运动物体多等地方），如下图所示： comparison_of_test_scenarios.png 运行算法 当无人机放置好后，可以开始运行算法： 判断是否正常初始化 如何判断算法是否正常完..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://emnavi-doc-img.oss-cn-beijing.aliyuncs.com/emnavi_assets/intro/vins_fusion_demo.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-27T10:27:15.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-27T10:27:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Vins-Fusion 视觉里程计\\",\\"image\\":[\\"https://emnavi-doc-img.oss-cn-beijing.aliyuncs.com/emnavi_assets/intro/vins_fusion_demo.png\\",\\"https://file.emnavi.tech/MEDIA_ASSETS/X152b/comparison_of_test_scenarios.png\\",\\"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_init_result.png\\",\\"https://file.emnavi.tech/MEDIA_ASSETS/X152b/vins_fusion_demo.png\\"],\\"dateModified\\":\\"2025-09-27T10:27:15.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"算法使用","slug":"算法使用","link":"#算法使用","children":[]}],"readingTime":{"minutes":3.9,"words":1169},"git":{"createdTime":1729388885000,"updatedTime":1758968835000,"contributors":[{"name":"Derkai","email":"2363104914@qq.com","commits":2}]},"autoDesc":true,"filePathRelative":"notes/X152b/2.算法部署/2.Vins-Fusion视觉里程计.md"}');export{_ as comp,f as data};
