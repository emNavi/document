---
title: Quadrotor Dynamics
createTime: 2025/01/29 22:05:11
permalink: /AirGym/AirGym-Sim/dynamics/
---

We consider an ideal dynamical model of quadrotor. We define the world $\mathcal{W}$ and body $\mathcal{B}$ frames with the orthonormal basis:  
$$\{\bm{x}_\mathcal{W},\bm{y}_\mathcal{W},\bm{z}_\mathcal{W}\}, \{\bm{x}_\mathcal{B},\bm{y}_\mathcal{B},\bm{z}_\mathcal{B}\} $$

The frame $\mathcal{B}$ is at the root of the quadrotor. Symbols with subscript mean variables under the corresponding coordination frame. The system dynamics can be expressed by the following equations:

$$
\begin{bmatrix}
\dot{\bm{p}}_{\mathcal{W}} \\
\dot{\bm{q}}_{\mathcal{B}} \\
\dot{\bm{v}}_{\mathcal{W}} \\
\dot{\bm \omega}_{\mathcal{B}} \\
\dot{\bm \Omega}
\end{bmatrix}
=
\begin{bmatrix}
\bm{v}_{\mathcal{W}} \\
\bm q_{\mathcal{B}} \cdot 
\begin{bmatrix}
0 & \bm \omega_{\mathcal{B}} / 2
\end{bmatrix}^\top \\
\frac{1}{m} \left( \bm q_{\mathcal{B}} \odot \bm f \right) + \bm g_{\mathcal{W}} \\
\bm J^{-1} \left( \bm \tau - \bm \omega_{\mathcal{B}} \times \bm J \bm \omega_{\mathcal{B}} \right) \\
T_\mathrm{m} \left( \bm \Omega_{\text{cmd}} - \bm \Omega \right)
\end{bmatrix}
$$

where $\bm p, \bm q, \bm v, \bm \omega, \bm \Omega$ represent position, quaternion, velocity, body rate (angular velocity), propeller rotation speed, respectively. $\bm \Omega_{\mathrm{cmd}}$ is the command of rotational speed, and $T_\mathrm{m}$ is the motor time constant, which can be estimated by rotational speed testing. $\bm J=\mathrm{diag} (I_x, I_y, I_z)$ denotes diagonal moment of inertia matrix. $m$ is the mass of quadrotor. Note the quaternion-vector product is denoted by $\odot$ representing a rotation of the vector by the quaternion as in   $\bm q \odot \bm v = \bm q \bm v \bm q^-$, where $\bm q^-$ is the quaternionâ€™s conjugate. $\bm g_\mathcal{W} = [ 0, 0, -9.81 ]^\top$ denotes gravity. $\bm f$ and $\bm \tau$ are the collective force and the torque produced by all propellers. The quantities are calculated as follows:
$$
\bm f=\sum_i f_i, \quad \bm \tau=\sum_i \tau_i+\bm r_{P, i} \times f_i
$$

where $\bm r_{P,i}$ denotes the location of propeller $i$ expressed in the body frame, $f_i$ and $\tau_i$ are forces and torques generated by the $i$th propeller, where we have:

$$
{f}_i( \Omega) = \begin{bmatrix} 0 & 0 & c_l \cdot  \Omega^2 \end{bmatrix}^\top
,
{\tau}_i( \Omega) = \begin{bmatrix} 0 & 0 & c_d \cdot  \Omega^2 \end{bmatrix}^\top
$$

where $c_l$ and $c_d$ are corresponding thrust and drag coefficients that can be obtained by system identification.
